2026-01-20 10:58:43,498 - INFO - Logging initialized. Log file: logs\pipeline_20260120_105843.log
2026-01-20 10:58:43,498 - INFO - ==================================================
2026-01-20 10:58:43,498 - INFO - Starting Veracore Data Pipeline
2026-01-20 10:58:43,499 - INFO - Execution time: 2026-01-20 10:58:43
2026-01-20 10:58:43,499 - INFO - ==================================================
2026-01-20 10:58:43,499 - INFO - All required environment variables are set.
2026-01-20 10:58:43,499 - INFO - ==================================================
2026-01-20 10:58:43,499 - INFO - ARCHIVING EXISTING CSV FILES
2026-01-20 10:58:43,499 - INFO - ==================================================
2026-01-20 10:58:43,499 - INFO - ARCHIVE: SHAREPOINT_URL = https://3plwinner.sharepoint.com
2026-01-20 10:58:43,499 - INFO - ARCHIVE: SHAREPOINT_FOLDER = /Shared Documents/Resideo Dashboard
2026-01-20 10:58:43,499 - INFO - ARCHIVE: SHAREPOINT_CLIENT_ID = SET
2026-01-20 10:58:43,499 - INFO - ARCHIVE: SHAREPOINT_CLIENT_SECRET = SET
2026-01-20 10:58:43,499 - INFO - ARCHIVE: Starting archive process for folder: /Shared Documents/Resideo Dashboard
2026-01-20 10:58:44,247 - INFO - ARCHIVE: Connected to site: 3PLWinner
2026-01-20 10:58:44,686 - INFO - ARCHIVE: Folder exists: True
2026-01-20 10:58:44,686 - INFO - ARCHIVE: Folder ServerRelativeUrl: /Shared Documents/Resideo Dashboard
2026-01-20 10:58:44,686 - INFO - ARCHIVE: Number of subfolders: 0
2026-01-20 10:58:44,686 - INFO - ARCHIVE: Files collection type: <class 'office365.sharepoint.files.file_collection.FileCollection'>
2026-01-20 10:58:44,686 - INFO - ARCHIVE: Files collection length: 0
2026-01-20 10:58:44,687 - INFO - ARCHIVE: Total files enumerated: 0
2026-01-20 10:58:44,687 - INFO - ARCHIVE: Attempting alternative method using list items...
2026-01-20 10:58:44,687 - ERROR - ARCHIVE: List method failed: No module named 'office365.sharepoint.caml_query'
2026-01-20 10:58:44,687 - INFO - ARCHIVE: No CSV files to archive
2026-01-20 10:58:44,688 - INFO - ==================================================
2026-01-20 10:58:44,688 - INFO - ARCHIVING COMPLETED SUCCESSFULLY
2026-01-20 10:58:44,688 - INFO - ==================================================
2026-01-20 10:58:44,688 - INFO - Attempting to get authorization token from VeraCore API
2026-01-20 10:58:44,688 - INFO - USERNAME: SET
2026-01-20 10:58:44,688 - INFO - PASSWORD: SET
2026-01-20 10:58:44,689 - INFO - SYSTEM_ID: SET
2026-01-20 10:58:44,689 - INFO - W_TOKEN: SET
2026-01-20 10:58:44,689 - INFO - USERNAME value: jannatipour.leena
2026-01-20 10:58:44,689 - INFO - SYSTEM_ID value: CUS529
2026-01-20 10:58:44,690 - INFO - Attempting direct token authentication...
2026-01-20 10:58:44,690 - INFO - Testing direct token against: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2026-01-20 10:58:44,962 - INFO - Direct token test - Status Code: 200
2026-01-20 10:58:44,962 - INFO - Direct token test - Response Headers: {'Date': 'Tue, 20 Jan 2026 18:58:46 GMT', 'Content-Type': 'application/json; charset=utf-8', 'Transfer-Encoding': 'chunked', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'cache-control': 'no-cache', 'pragma': 'no-cache', 'expires': '-1', 'x-aspnet-version': '4.0.30319', 'x-powered-by': 'ASP.NET', 'x-xss-protection': '1; mode=block', 'set-cookie': 'SRV=s1; path=/', 'cf-cache-status': 'DYNAMIC', 'Server': 'cloudflare', 'CF-RAY': '9c10ce1cec02ed3f-SJC'}
2026-01-20 10:58:44,962 - INFO - âœ“ Direct token authentication successful!
2026-01-20 10:58:44,965 - INFO - Fetching data from API endpoint: https://wms.3plwinner.com/VeraCore/Public.Api/api/reports
2026-01-20 10:58:45,483 - INFO - Skipping SharePoint upload for available_reports_endpoint.csv
2026-01-20 10:58:45,483 - INFO - Deleted local file: C:\Users\jannatipour.leena\Downloads\ResideoDashboard\output_20260120_105843\available_reports_endpoint.csv
2026-01-20 10:58:45,484 - INFO - Processing report 1/1: ResideoDashboardOrderStatus
2026-01-20 10:58:45,484 - INFO - Processing report: ResideoDashboardOrderStatus
2026-01-20 10:58:50,190 - INFO - Task started. Task ID: 59673
2026-01-20 10:58:50,387 - INFO - Report status: Created (attempt 1)
2026-01-20 10:58:56,796 - INFO - Report Completed
2026-01-20 10:58:57,215 - INFO - Report data saved to OrderStatus.csv
2026-01-20 10:58:57,216 - INFO - Starting SharePoint upload process...
2026-01-20 10:58:57,216 - INFO - Local file: C:\Users\jannatipour.leena\Downloads\ResideoDashboard\output_20260120_105843\OrderStatus.csv
2026-01-20 10:58:57,216 - INFO - SharePoint filename: OrderStatus_20260120_105857.csv
2026-01-20 10:58:57,216 - INFO - SharePoint Client Credential authentication successful
2026-01-20 10:58:57,897 - INFO - Uploading file: OrderStatus_20260120_105857.csv
2026-01-20 10:58:58,433 - INFO - Successfully uploaded: OrderStatus_20260120_105857.csv
2026-01-20 10:58:58,433 - INFO - SharePoint URL: https://3plwinner.sharepoint.com/Shared Documents/Resideo Dashboard/OrderStatus_20260120_105857.csv
2026-01-20 10:58:58,434 - INFO - Successfully uploaded OrderStatus.csv to SharePoint
2026-01-20 10:58:58,434 - INFO - ==================================================
2026-01-20 10:58:58,434 - INFO - Pipeline Summary:
2026-01-20 10:58:58,434 - INFO - Successful reports: 1 / 1
2026-01-20 10:58:58,434 - INFO - Completed at: 2026-01-20 10:58:58
2026-01-20 10:58:58,435 - INFO - ==================================================
2026-01-20 10:58:58,435 - INFO - Pipeline Completed Successfully
